{
    "version": "7.9.14314",
    "homepage": "https://im.qq.com",
    "description": "QQ",
    "license": "Freeware",
    "notes": [
        "Restart C:/windows/explorer.exe before uninstall QQShellExt64.dll"
    ],
    "url": "http://dldir1.qq.com/qqfile/qq/QQ7.9Light/14314/QQ7.9Light.exe",
    "hash": "9bbe55a444ea8317fe2650a48e7bd9e3470cbb516ce045e76802ecdd191b24ac",
    "pre_download": "Assert-Administrator",
    "pre_install": [
        "$null, $bucket = find_manifest($app)",
        "$bucketdir = Find-BucketDirectory($bucket)",
        "",
        "",
        "$QQ_INST_PATH = \"$(current_dir $dir)\".Replace('/', '\\\\')",
        "$QQ_INST_PATH = \"$dir\".Replace('/', '\\\\')",
        "$escdir = $QQ_INST_PATH -replace \"\\\\\",\"\\\\\"",
        "(gc \"$bucketdir\\..\\scripts\\qqlite\\install-qqlite.reg.templ\") | % {$_ -replace \"%QQ_INST_PATH%\",\"$escdir\"} | out-file -enc oem \"$dir\\install-qqlite.reg\"",
        "cp \"$bucketdir\\..\\scripts\\qqlite\\uninstall-qqlite.reg\" \"$dir\"",
        "",
        "sudo regedit.exe /s \"$dir\\install-qqlite.reg\"",
        "",
        ""
    ],
    "installer": {
        "script": [
            "#$qqRoaming = \"$env:APPDATA\\Tencent\\QQ\"",
            "#if (!(Test-Path $qqRoaming)) {",
            "#    New-Item -Path \"$qqRoaming\" -ItemType Directory | Out-Null",
            "#} else {",
            "#    Get-ChildItem -Path \"$dir\\Application Data\\Tencent\\QQ\" -Name | ForEach-Object {",
            "#        if (Test-Path \"$qqRoaming\\$_\") {",
            "#            Remove-Item \"$qqRoaming\\$_\" -Recurse -Force",
            "#        }",
            "#    }",
            "#}",
            "#",
            "#$qqCommonFiles = \"$env:COMMONPROGRAMFILES\"",
            "#sudo Move-Item \"$dir\\Common\\Tencent\" \"$qqCommonFiles\" -Force",
            "#",
            "#Move-Item \"$dir\\Application Data\\Tencent\\QQ\\*\" \"$qqRoaming\" -Force",
            "#Move-Item \"$dir\\Files\\*\" \"$dir\" -Force",
            "#@('Application Data', 'Common', 'Files') | ForEach-Object {",
            "#    Remove-Item \"$dir\\$_\" -Recurse -Force",
            "#}",
            "",
            "Write-Host \"S1. install program 'qqlite' with native method\" -ForegroundColor DarkCyan",
            "Start-Process $dir\\QQ7.9Light.exe -ArgumentList \"/VERYSILENT\",\"/SUPPRESSMSGBOXES\",\"/DIR=`\"$dir`\"\" -Wait -Verb RunAs",
            "",
            ""
        ]
    },
    "uninstaller": {
        "script": [
            "",
            "Write-Host \"S1. uninstall program 'qqlite' with native method\" -ForegroundColor DarkCyan",
            "Start-Process $dir\\QQUninst.exe -ArgumentList \"/VERYSILENT\",\"/SUPPRESSMSGBOXES\" -Wait -Verb RunAs",
            "",
            "Remove-Item \"$env:APPDATA\\Tencent\\QQ\" -Recurse -Force",
            "sudo regedit.exe /s \"$dir\\uninstall-qqlite.reg\"",
            "",
            "gps explorer | spps",
            ""
        ]
    },
    "shortcuts": [
        [
            "Bin\\QQScLauncher.exe",
            "腾讯QQ轻聊版"
        ]
    ],
    "checkver": {
        "url": "https://pc.qq.com/detail/2/detail_2.html",
        "regex": "QQ([\\d.]+)\\.exe"
    },
    "autoupdate": {
        "url": "https://dl.softmgr.qq.com/original/im/QQ$version.exe#/dl.7z"
    }
}